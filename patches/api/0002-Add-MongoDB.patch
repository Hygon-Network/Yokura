From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Hygon <hygon806@gmail.com>
Date: Sun, 19 Sep 2021 13:11:13 +0200
Subject: [PATCH] Add MongoDB


diff --git a/build.gradle.kts b/build.gradle.kts
index 689d470ebe2c7e25e4c87f6127978d1d283e55b5..015f91f62b4dd4efd5ad584207db7cd367d3aa1e 100644
--- a/build.gradle.kts
+++ b/build.gradle.kts
@@ -25,6 +25,7 @@ configurations.api {
 
 dependencies {
     // api dependencies are listed transitively to API consumers
+    api("org.mongodb:mongo-java-driver:3.12.10") // Yokura
     api("commons-lang:commons-lang:2.6")
     api("com.google.guava:guava:21.0")
     api("com.google.code.gson:gson:2.8.0")
diff --git a/src/main/java/fr/hygon/yokura/IYokuraAPI.java b/src/main/java/fr/hygon/yokura/IYokuraAPI.java
new file mode 100644
index 0000000000000000000000000000000000000000..ff3658c487a52502dc9a529b3d92a67eb8cc7513
--- /dev/null
+++ b/src/main/java/fr/hygon/yokura/IYokuraAPI.java
@@ -0,0 +1,16 @@
+package fr.hygon.yokura;
+
+import com.mongodb.MongoClient;
+import com.mongodb.client.MongoDatabase;
+
+public interface IYokuraAPI {
+    /**
+     * @return the mongo client instance
+     */
+    MongoClient getMongoClient();
+
+    /**
+     * @return the default database used by the server
+     */
+    MongoDatabase getMongoDatabase();
+}
\ No newline at end of file
diff --git a/src/main/java/fr/hygon/yokura/YokuraAPI.java b/src/main/java/fr/hygon/yokura/YokuraAPI.java
new file mode 100644
index 0000000000000000000000000000000000000000..f3d2bdb4a2dc10737eabbf9f35d0231fef706ee3
--- /dev/null
+++ b/src/main/java/fr/hygon/yokura/YokuraAPI.java
@@ -0,0 +1,37 @@
+package fr.hygon.yokura;
+
+import com.mongodb.MongoClient;
+import com.mongodb.client.MongoDatabase;
+
+public class YokuraAPI {
+    private static IYokuraAPI instance;
+
+    /**
+     * Attempts to set the {@link IYokuraAPI} singleton.
+     * <p>
+     * Cannot be done if the instance is already set.
+     *
+     * @param instance IYokuraAPI instance
+     */
+    public static void setInstance(IYokuraAPI instance) {
+        if(YokuraAPI.instance != null) {
+            throw new UnsupportedOperationException("Cannot redefine singleton YokuraAPI");
+        }
+
+        YokuraAPI.instance = instance;
+    }
+
+    /**
+     * @return the mongo client instance
+     */
+    MongoClient getMongoClient() {
+        return instance.getMongoClient();
+    }
+
+    /**
+     * @return the default database used by the server
+     */
+    MongoDatabase getMongoDatabase() {
+        return instance.getMongoDatabase();
+    }
+}
